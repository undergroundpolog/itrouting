package com.intraffic.itrouting.core;

import com.opensymphony.xwork2.ActionSupport;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Vector;
import com.intraffic.utils.Verification.Patterns;

/**
 *
 * @author intraffic
 */
public class GetPath extends ActionSupport {
    private String check_status, source_node, target_node, source, target, node, cost, dir, timestamp, format, preference, theta, midpoints;
    private double x1, y1, x2, y2;
    private HashMap path;
    private static Neo4jGraph graph;
    private final int LON = 0;
    private final int LAT = 1;
    private final int AZI = 2;
    private final int CUS_AZI = 3;
    
    private static String[][][] azi_options;
    private static HashMap<String,String> keys;
        
    /**
     * Constructor.
     */
    public GetPath() {
        this.azi_options = new String[2][4][2];
        azi_options[0][0][0] = "0"; azi_options[0][0][1] = "0";
        azi_options[0][1][0] = "0"; azi_options[0][1][1] = "180";
        azi_options[0][2][0] = "180"; azi_options[0][2][1] = "0";
        azi_options[0][3][0] = "180"; azi_options[0][3][1] = "180";

        azi_options[1][0][0] = "90"; azi_options[1][0][1] = "90"; 
        azi_options[1][1][0] = "90"; azi_options[1][1][1] = "270"; 
        azi_options[1][2][0] = "270"; azi_options[1][2][1] = "90"; 
        azi_options[1][3][0] = "270"; azi_options[1][3][1] = "270";

        this.keys = new HashMap<String,String>();
        keys.put("0","0,0");
        keys.put("180","0,3");
        keys.put("90","1,0");
        keys.put("270","1,3");
    }
    
    /**
     * Set the midpoints param 
     * @param midpoints a set of points in the format 'lon,lat[,azimuth]' delimited by '|'
     */
    public void setMidpoints(String midpoints) {this.midpoints = midpoints;}
    
    
    /**
     * Set the theta param 
     * @param theta if given, must be a value between 0 and 1, including both
     */
    public void setTheta(String theta) {this.theta = theta;}
    
    /**
     * Set the preference
     * @param preference if given, the value must be 'highway' or 'secondary' 
     */
    public void setPreference(String preference) {this.preference = preference;}
    
    /**
     * Set the source point of the path.
     * @param source Must be a point in the format 'lot,lan[,azimuth]'
     */
    public void setSource(String source) {this.source = source;}
    
    /**
     * Set the response format
     * @param format Must be 'json', 'geojson' or none
     */
    public void setFormat(String format) {this.format = format;}
    
    /**
     * Set the target point of the path.
     * @param target Must be a point in the format 'lot,lan[,azimuth]'
     */
    public void setTarget(String target) {this.target = target;}
    
    /**
     * Set the cost type.
     * @param cost Use 'rt' for real time cost or 'normal' for normal cost
     */
    public void setCost(String cost) {this.cost = cost;}
    
    /**
     * Set the LINK_ID that will be updated.
     * @param node Must be a LINK_ID
     */
    public void setNode(String node) {this.node = node;}
    
    /**
     * Set the link direction.
     * @param dir Must be 'P' for prescribed, otherwise 'C'
     */
    public void setDir(String dir) {this.dir = dir;}
    
    /**
     * Set the timestamp of the speed that will be used to set the confidence.
     * @param timestamp SQL timestamp format
     */
    public void setTimestamp(String timestamp) {this.timestamp = timestamp;}
    
    /**
     * Build the json or geojson of the path
     * @param result_path path
     */
    private void prepareResponse(ArrayList<String> result_path) {
        String[] elem, points;
        String linestring;
        this.format = (format == null ? "json" : this.format);
        if(this.format.equals("geojson")) {

            Vector<HashMap> features = new Vector<HashMap>();
            HashMap<String,Object> featureColl = new HashMap<String, Object>();


            for(String elem_s : result_path) {
                //coordinate
                Vector<Vector> coordinates = new Vector<Vector>();

                elem = elem_s.trim().split(",");
                linestring = elem[3];
                points = linestring.split("\\|");
                for(String p : points) {
                    Vector<Double> point = new Vector<Double>();
                    point.add(Double.parseDouble(p.split(" ")[0]));
                    point.add(Double.parseDouble(p.split(" ")[1]));
                    coordinates.add(point);
                }

                //geometry
                HashMap<String,Object> geometry = new HashMap<String, Object>();
                geometry.put("type","LineString");
                geometry.put("coordinates",coordinates);

                //features_hash (contiene info de cada link)
                HashMap<String,Object> feature_hash = new HashMap<String, Object>();
                feature_hash.put("type", "Feature");
                feature_hash.put("geometry", geometry);
                feature_hash.put("properties",new HashMap<String,Object>());
                //features               
                features.add(feature_hash);    
            }

            //featurecollection
            featureColl.put("type", "FeatureCollection");
            featureColl.put("features", features);

            this.path = featureColl;

        } else {
            Vector<HashMap<String,Object>> json_path = new Vector<HashMap<String,Object>>();
            Vector<Integer> values = new Vector<Integer>();
            for(String elem_s : result_path) {
                //System.out.println("ITR2: "+elem_s);
                HashMap<String,Object> link_info = new HashMap<String,Object>();
                elem = elem_s.split(",");
                link_info.put("id",Integer.parseInt(elem[1]));
                values.add(Integer.parseInt(elem[1]));
                link_info.put("direction",Boolean.parseBoolean(elem[4]));
                json_path.add(link_info);

            }

            //this.path.put("path", json_path);
            this.path.put("path", values);
        }

        result_path.clear();
    }
    
    /**
     * Prepare the points that will be used to find the path, The preparation include set the default azimuth if not given for some points.
     */
    private String[][] preparePoints() {
        String all_points = this.source + "|" + (this.midpoints == null ? "" : this.midpoints + "|") + this.target;
        System.out.println(all_points);
        String[] all_points_arr = all_points.split("\\|");
        String[][] allPoints = new String[all_points_arr.length][4];
        String[] A_pointArr, B_pointArr;
        double Ay, Ax, By, Bx;
        int Atam, Btam;
        for(int i = 0; i < all_points_arr.length - 1; i++) {
            A_pointArr = all_points_arr[i].split(",");
            B_pointArr = all_points_arr[i+1].split(",");
            Atam = A_pointArr.length;
            Btam = B_pointArr.length;
            Ax = Double.parseDouble(A_pointArr[this.LON]);
            Ay = Double.parseDouble(A_pointArr[this.LAT]);
            Bx = Double.parseDouble(B_pointArr[this.LON]);
            By = Double.parseDouble(B_pointArr[this.LAT]);
            
            //lat lon
            //A
            allPoints[i][this.LON] = A_pointArr[this.LON];
            allPoints[i][this.LAT] = A_pointArr[this.LAT];
            allPoints[i][this.CUS_AZI] = Atam == 3 ? "true" : "false";
            
            //B
            allPoints[i+1][this.LON] = B_pointArr[this.LON];
            allPoints[i+1][this.LAT] = B_pointArr[this.LAT];
            allPoints[i+1][this.CUS_AZI] = Btam == 3 ? "true" : "false";
            
            
            //azimuth
            if(Ay > By) {
                if(i == 0)
                    allPoints[i][this.AZI] = (Atam  == 3 ? A_pointArr[this.AZI] : "180");
                allPoints[i+1][this.AZI] = (Btam  == 3 ? B_pointArr[this.AZI] : "180");
            } else if(Ay < By) {
                if(i == 0)
                    allPoints[i][this.AZI] = (Atam  == 3 ? A_pointArr[this.AZI] : "0");
                allPoints[i+1][this.AZI] = (Btam  == 3 ? B_pointArr[this.AZI] : "0");
            } else {
                if(Ax < Bx) {
                    if(i == 0)
                        allPoints[i][this.AZI] = (Atam  == 3 ? A_pointArr[this.AZI] : "90");
                    allPoints[i+1][this.AZI] = (Btam  == 3 ? B_pointArr[this.AZI] : "90");
                } else {
                    if(i == 0)
                        allPoints[i][this.AZI] = (Atam  == 3 ? A_pointArr[this.AZI] : "270");
                    allPoints[i+1][this.AZI] = (Btam  == 3 ? B_pointArr[this.AZI] : "270");
                }
            }
            
            System.out.println(allPoints[i][this.LON]+","+allPoints[i][this.LAT]+","+allPoints[i][this.AZI]+" - "+allPoints[i+1][this.LON]+","+allPoints[i+1][this.LAT]+","+allPoints[i+1][this.AZI]);
        }
        
        return allPoints;
        
    }
    
    /**
     * Check the inputs params.
     * @return 
     */
    private String checkParams() {
        //source
        Patterns patt = new Patterns();
        if(!patt.isValidPoint(source)) 
            return "El punto inicial debe ser tener el formato 'lon,lat[,azimuth]', donde 'lon','lat' y 'azimuth' pueden ser enteros o flotantes";
        
        if(!patt.isValidPoint(target)) 
            return "El punto final debe ser tener el formato 'lon,lat[,azimuth]', donde 'lon','lat' y 'azimuth' pueden ser enteros o flotantes";
        
        if(!patt.isValidCost(cost)) 
            return "El costo debe ser 'length', 'ftt' o 'rt'";
        
        if(!patt.isValidFormat(format)) 
            return "El formato debe ser 'json' o 'geojson'";
        
        if(!patt.isValidPreference(preference)) 
            return "La preferencia debe ser 'highway' o 'secondary'";
        
        if(!patt.isValidMidpoints(midpoints)) 
            return "Los puntos deben tener el formato 'lon,lat[,azimuth]'. Cada punto debe estar delimitado por un '|'";
               
        return null;
    }
    
    /**
     * Given a source, target and a cost type, perform a A* and return the best path, The result is a JSON that has nodes, links and costs.
     * @throws Exception 
     */
    @Override
    public String execute() throws Exception {
        if((check_status = this.checkParams()) != null) {
            this.path = new HashMap();
            this.path.put("name","Internal Error");
            this.path.put("message", check_status);
            return ERROR;
        }

        if(this.graph == null) {
            this.initAll();
        }
        
        ArrayList<String> result_path, relative_path;
        String [][] allPoints;
        try {
            this.path = new HashMap();
            
            //get path
            //TEST
            /*if (this.source.trim().equals("1,1")) {
                Double[] X = {-66.972155,-66.9706420860422,-66.9336263094517,-66.93284,-66.909702041958,-66.9320084013555,-66.9088496528455,-66.9086847471413,-66.93317,-66.90858,-66.962585,-66.963955,-66.958695,-66.9493950351103,-66.94833,-66.948705,-66.9528205670535,-66.958075,-66.96742,-66.94771,-66.9580940426808,-66.9521154500324,-66.964945,-66.94683,-66.94662,-66.96552,-66.9538411691878,-66.95729,-66.94815,-66.9713866046318,-66.959905,-66.96683,-66.961545,-66.966295,-66.970385,-66.969625,-66.94738,-66.950810351767,-66.9558369787491,-66.94796,-66.947075,-66.96831,-66.96612,-66.930125,-66.9301950255265,-67.0415988982466,-66.9003037086458,-66.924355,-67.0118633441389,-66.9360113946804,-66.9452829032039,-66.950115,-67.03968,-66.9775181216851,-67.020226327083,-66.9437952345494,-66.9441181275218,-66.88237,-66.8841407023327,-66.8829395310761,-66.881684919471,-66.8695492939497,-66.9478380003963,-66.94788,-66.94776,-66.9476515297405,-66.97916,-66.874765,-66.952006913508,-67.0195049613894,-66.87182,-66.90749,-66.907605,-66.90719,-66.90693,-66.906675,-66.90734,-66.90741,-66.90738,-66.9064511658234,-66.939885,-66.9397750372644,-66.919525,-66.888675,-66.9837184082299,-66.9856758903499,-66.9848459319041,-66.9841692528472,-66.982178113126,-66.9073160762295,-66.934225,-66.9292161436534,-66.9293964098139,-66.929633208726,-66.9293188083033,-66.9297019500064,-66.989015,-67.02146613812,-66.9576890065694,-66.977474584847,-66.90444,-67.0197709298881,-66.961565,-66.94562,-66.9455737960813,-66.99282,-66.9771873079218,-66.9343620626747,-66.9974781891556,-66.99717,-66.8951,-66.929395,-66.929,-67.0274423233786,-66.87579,-66.9453824239957,-66.9810555959043,-66.9703590039232,-66.9724371838745,-66.9346709444117,-66.9406600862105,-66.939705,-66.9419413796619,-66.9393576680172,-66.93462,-66.9130895486984,-66.872615,-66.87206,-66.871635,-66.95781,-66.9449114873305,-66.94486,-66.9453524343592,-66.9275366256875,-66.94458,-66.94607,-66.880136743409,-66.8802454640059,-66.944785,-66.89068,-66.89062,-66.97679,-67.0111973668556,-67.0101505308196,-66.9600212764793,-67.0246054309866,-67.00439,-66.967618203683,-66.8905429705083,-67.0015364889708,-67.0013412310681,-67.057675,-66.9936854434732,-66.9727313643579,-66.97262,-66.9446098482085,-66.9996375211466,-66.9978575753968,-66.9950293177791,-66.9999267496339,-66.9490040882938,-66.948575,-66.9485990842893,-66.9485291355931,-66.951435,-66.89899,-67.0213516771563,-66.94032,-66.963475,-67.048194644998,-66.9455257290258,-66.9465691567938,-66.94643,-66.9466444940567,-66.9459986187072,-66.946415,-66.94656,-66.94673,-66.94635,-66.9699447336247,-66.9705718376199,-66.971200458134,-66.9714196591747,-66.9090226946162,-66.9627686310237,-66.89471,-66.8946807804555,-66.89468,-66.9108,-66.9142145205441,-66.91105,-66.912305,-66.910935,-66.911475,-66.9108876616386,-66.91122,-66.91177,-66.9329813836887,-66.9333058121133,-66.93031,-66.9327286853667,-66.935953975918,-66.9329123402066,-66.9346428929001,-66.9294460997378,-66.9317958841915,-66.9337453760092,-66.93492,-66.935405,-66.9358873004671,-66.9308798913072,-66.931385,-66.903285,-66.9031039490639,-66.91963,-66.91936,-66.9979335364319,-66.9966520345225,-66.9975782955544,-66.955704837893,-66.8919910158138,-66.8936334747892,-66.890785,-66.89254,-66.89152,-66.892895,-66.8909339537088,-66.9312021173653,-66.92013,-66.9211092899111,-66.922325,-66.92049,-66.9218524695167,-66.972027212547,-66.9719750826673,-66.971565772299,-66.9717300378557,-66.97170800434,-66.9701973520097,-66.9518957943913,-66.951554115654,-66.95218,-66.9071275192456,-66.9037646531346,-66.9756190062377,-66.9813984715278,-66.93773,-66.88751,-67.0128991268312,-67.00173,-66.954145,-66.9061928974668,-66.949425,-66.948785,-66.949985,-66.949105,-66.94972,-66.8865800383803,-66.9234549138688,-66.9241899082985,-66.936758425993,-66.927615,-66.9442296741358,-66.8985241692488,-66.8989768333759,-66.969625,-67.0159354071015,-66.9445082836392,-66.9267834977759,-66.92585,-67.0087143049139,-66.9834553143938,-66.9817107517573,-66.978597703119,-66.9799042776513,-66.9841450533313,-66.9807479735291,-66.9823229545343,-66.9773325139435,-66.9786081034738,-66.982,-66.9314601864023,-66.9822093926494,-66.9829362497713,-66.91871,-66.918845,-66.918505,-66.91893,-66.918795,-66.9436545108482,-66.965657294646,-66.9545868938074,-66.952688291699,-66.86919,-66.869286054273,-66.87014620173,-66.8696640361782,-66.906059639115,-66.9060901808565,-66.904245,-67.013945,-66.97287,-66.928065,-66.9609160050782,-66.9618978767152,-66.9624700372617,-66.962305,-67.01235,-67.0125226081857,-67.0124367060785,-67.0132171598414,-67.0120186572279,-67.0135909738143,-66.9045156458777,-66.90448,-66.9955980531695,-66.9883215051534,-66.95965,-66.95938,-66.9600203029522,-66.934515,-66.972595,-66.972364938746,-66.9880994674782,-67.046735,-66.9613245371992,-66.9608798833273,-66.96017,-67.145029550956,-66.9887421611864,-66.8866413344926,-66.88715,-66.97768,-67.0053061191281,-66.883535,-66.88349,-66.960575,-66.960325,-66.9607960251985,-67.1129966254228,-67.1137141414219,-67.0136,-66.9721593929426,-66.9448,-66.906793087957,-66.94816,-66.8901666223231,-66.90521,-66.9045059953998,-66.904633895193,-66.904665,-66.90486778601,-66.9398822972356,-66.9019834999455,-66.923585,-66.9448920063766,-66.951104485488,-66.95128,-66.9881150082205,-66.9891136281316,-67.108665,-67.009932686392,-66.9971550326124,-66.9674205259553,-67.0408116413561,-67.0224447253917,-67.0240040215538,-67.0356563869247,-67.0051125037039,-66.9713838360419,-67.0770356279124,-66.9872943471433,-67.0814632145494,-67.1173987126043,-66.9945078944009,-67.0195555532742,-67.0164448897733,-67.0071659083101,-67.0045884458302,-67.0821370137202,-67.0795934680668,-66.9634587619531,-67.0308456127875,-66.9930960465883,-67.054621164318,-67.049633384444,-66.9890507185069,-66.9924490980174,-66.999975,-67.0992919029821,-67.0118471019422,-66.9995751844768,-67.0688719122814,-67.0007744846823,-67.1124499072108,-67.0462762689536,-67.0210899826615,-67.043505643672,-67.12,-67.0818438845096,-66.9899055479389,-67.070445151061,-66.9913993118253,-67.0252357482247,-66.9820686712216,-67.0740614497069,-67.0779758562601,-67.02074,-67.1252377015738,-67.038135,-67.133565721916,-66.9865138194079,-67.07849,-67.0584377284135,-67.0392170353952,-67.0342163763876,-67.010775,-67.0039953205758,-67.0025958257615,-67.1293,-67.07749,-66.9644764491202,-67.0376822222442,-67.02144,-67.078914445651,-67.0806488339203,-66.9304202223391,-66.9304,-66.95934,-66.9607860167804,-66.959805,-66.92846282353,-66.9280822333194,-66.9277584164079,-66.9282789780849,-66.89049301979,-66.8916566185888,-66.8937708395915,-66.8914680912018,-66.89299,-66.89253,-66.909729569623,-66.91037,-66.90625,-66.89175,-66.892115,-66.89337,-66.8911151247999,-66.889405,-66.8918502388589,-66.89166,-66.8915053412585,-66.8912848182416,-66.89172,-66.8916215127489,-66.891965,-66.891685,-66.9124553042252,-66.913045,-66.9115426053262,-66.90857,-66.909135,-66.90779,-67.0006169057688,-66.9690028346121,-66.9938892406623,-66.9865275358165,-66.887115,-66.9209121650164,-66.95908,-66.959205,-66.95934,-66.95948,-66.959015,-66.9236826347399,-66.9675745430275,-66.8913016576444,-66.913388921372,-66.9112007052767,-66.9253796199324,-66.9259790098049,-66.98373,-66.9268370880529,-66.9825078044265,-66.9400252878514,-66.9400617976124,-66.9873765914268,-67.049905,-66.889953308749,-66.88858,-66.88906,-66.9407306755452,-66.9865851149375,-66.9343330805104,-66.9331183392103,-66.96932362705,-66.9656834200919,-66.981235,-66.898645,-66.895135,-66.8972987591942,-66.8967143930733,-66.8980122873192,-66.8975415203063,-66.8969529308901,-66.8987087394974,-66.8985348544632,-66.8977726087504,-66.8965004080863,-66.8985352135447,-66.8985800749106,-66.8984464597191,-66.9596542304568,-66.9272626109021,-66.927725,-66.9274457289481,-67.0204238971021,-66.9726920043735,-66.9276729133548,-66.946395,-66.94864,-66.9479833487027,-66.9718046252927,-66.9927289095236,-66.9298958416433,-66.98367,-66.9835705563492,-67.0711,-67.0710486489438,-66.9918,-66.99205,-66.9913950936092,-66.9925843211503,-66.9253449449689,-66.8846204346988,-66.9783714336215,-67.0076497206129,-66.9672088654998,-66.887625,-66.958345,-67.0230543857823,-67.0238782759501,-67.0217112934311,-67.0219975095864,-66.953445,-66.917875,-67.0471632102785,-66.8989225543222,-66.9234953397347,-66.916925,-66.88642,-66.8862774738129,-66.88788,-66.8859164192824,-66.88759163794,-66.8868000054702,-66.8872938856207,-66.887675,-66.8869874638187,-66.886515,-66.887995,-66.88729,-66.93607,-66.908809213644,-66.90818,-67.026166459464,-67.02571,-67.0243655441949,-67.0262215232979,-67.012129894326,-67.039995,-67.0015734645241,-66.9473998481218,-66.9741,-66.9056,-66.92443,-66.94999332343,-66.9504543790988,-66.9499467814511,-66.9532172328052,-66.9495465344759,-66.9507073285048,-66.9522230173758,-66.974415,-66.876232502371,-66.86967,-66.96388,-66.9631847734723,-66.963645,-66.92726,-66.925865,-66.9259961004585,-66.9266331711988,-66.9696908171512,-66.969435,-66.94506,-66.944308980867,-66.944745,-66.9504334763776,-66.9450166519535,-66.9451470943059,-66.94575,-66.94566,-66.9443152215333,-66.944519016649,-66.9453685017134,-66.94983,-66.945135,-66.945845,-66.9452295126938,-66.94519,-66.9453323575687,-66.945095,-66.92291,-66.922825,-67.0206255634272,-66.926725,-66.895695,-66.980325,-67.0030064690778,-66.898845,-66.9965,-66.9256317081825,-66.9464695568943,-66.904865,-66.9053080341174,-66.9050952165934,-66.9046777729484,-66.94222,-66.9993460259374,-66.957185,-66.9577266030826,-66.9532872300493,-66.93707,-66.9363182008414,-66.9367263197292,-66.9358605850468,-66.9782287018957,-66.972725,-66.881915,-66.88291,-66.928725,-66.9577532686121,-66.958265,-66.9587989592198,-67.0480357464375,-66.9130370522212,-66.912005,-66.9261587771589,-66.91248205299,-66.8828034815618,-66.91273,-66.9266307832973,-66.912895,-66.9272716569316,-66.9393610385243,-67.0079276766654,-67.0048043290858,-67.0066718866791,-66.9941547719932,-66.9014578433198,-66.9590205434862,-66.948475,-66.94947,-66.950305,-66.949995,-66.94892,-66.95846,-66.9630744469296,-66.9255986132406,-66.953315,-66.925925,-66.9487466318974,-66.9536164163,-66.95915,-66.9609053443284,-66.9427833641119,-66.957845,-66.958975,-66.9436,-66.9461817088165,-66.943668660451,-66.9541799835193,-66.95483757216,-66.9575843173753,-66.9466040703495,-66.9619109021514,-66.913665,-66.9605747992794,-66.91418,-66.96459,-66.9594793742154,-66.954585,-66.95982,-66.9432522601474,-66.9267547848676,-66.92554,-66.9612631213234,-66.944585,-66.95293,-66.92882,-66.922155,-66.92207,-66.971725,-66.8770526365387,-66.8780458590101,-66.877645,-66.974375,-66.91447,-66.9409090430377,-66.9409277209596,-67.00419,-66.9727628141731,-66.9811183985834,-66.9791229243969,-66.9794811846508,-66.9286039894925,-66.9704327451569,-66.9703976384628,-66.9695329354623,-66.9706242241973,-66.9978288564563,-66.9975705425674,-66.9641885994506,-66.902945,-66.950223224221,-66.9296442839138,-66.92929,-66.9593682678951,-66.9291898980326,-66.92759,-66.9278125441469,-66.869665,-66.9634927334663,-66.9759621906264,-66.896839097498,-66.99935,-66.94924,-66.8877144285101,-66.9994198370116,-67.0468914453536,-66.895394684418,-66.92757,-66.97962,-66.9582857106781,-66.9577160092266,-66.9532690475323,-66.954727786646,-66.95269,-66.9528574222794,-66.9557727642594,-66.9528132046729,-66.951955,-66.954477818865,-66.9523875411604,-66.9535860201245,-66.9548208290279,-66.9286593024146,-66.9223568322939,-66.963138842056,-66.9476790784998,-66.886205,-66.8856436386828,-66.9431554454163,-66.942156604218,-66.9174391862004,-66.9327532022421,-66.896625,-66.897845,-66.89685,-66.89716,-66.8983020473159,-66.897505,-66.9849079007772,-66.9740686376733,-66.9797904049843,-66.989927039516,-66.97300897656,-66.9926949227953,-66.9985347429374,-66.9876628638092,-66.9436854297315,-66.9510009189323,-66.95092,-66.95089,-66.944895,-66.937465,-66.926605,-66.92615,-66.937565,-66.9258509559027,-66.9376754423928,-66.9372213807597,-66.92611,-66.9266873824115,-66.9263435579372,-67.0485508249246,-67.0482596746211,-67.0574591627881,-66.91722,-66.919385,-66.91494,-66.91448,-66.918425,-66.9202145584836,-66.9159729567912,-66.9138898728928,-66.9159904317829,-67.0008005730488,-66.9407491059809,-66.9402125193318,-66.9431444746418,-66.940315,-66.94026,-66.94199,-66.9406756972693,-66.9404389467498,-66.94156,-66.972665,-67.0195171785123,-67.0175029509771,-67.018155,-67.0164838085284,-66.872201387375,-66.8742431211721,-66.8730562305696,-66.976822127731,-66.966319669034,-66.9342291849039,-67.0502907581917,-66.95744,-66.9084506426777,-66.92414,-66.9395172479893,-66.9297379987504,-66.922375,-67.0199313079187,-66.9923240009033,-66.9468781932405,-66.9669773061418,-67.030659942543,-66.953704095918,-66.9420187836092,-66.9304608707549,-66.964919286895,-66.9408502045494,-66.9350695057322,-66.9337446761552,-66.9347350487466,-66.9329305085933,-67.0030209871046,-66.890855,-66.89042,-66.888845,-66.888735,-66.91129,-66.9103161914841,-66.911485,-66.907175,-66.90415,-66.90521,-66.9120510588485,-66.9924432553225,-66.99218,-66.992495,-66.9239454759186,-66.9179929753695,-66.9839971718928,-66.87323,-66.873604164903,-66.9469516968927,-66.9226826403699,-66.92705,-66.9502712721365,-66.945725,-66.9379247064354,-66.9279418068703,-66.9413518110956,-66.9459809372884,-66.9331392408365,-66.9263569500453,-66.92001,-66.9445501334076,-66.93022,-66.9469084088875,-66.92034,-66.9337612961107,-66.9508516724776,-66.947952219955,-66.9249084408254,-66.9297961055469,-66.9195295801444,-66.9330358971206,-66.945715,-66.9431370216642,-66.9343979660179,-66.9471277993633,-66.9332549862952,-66.9478058874657,-66.943226949969,-66.944955,-66.9437306467982,-66.944455,-66.945055,-66.93980271452,-66.9415084929598,-66.9712924493252,-66.973125,-66.9500277105436,-66.9498912615691,-66.9957282645128,-66.9922804732599,-66.9934806482485,-66.993413297018,-66.9934863302816,-66.8854224373924,-66.884705,-66.94732,-66.938255,-66.9370862101126,-66.9512163785711,-66.9434544171914,-66.9337199044347,-66.94721,-67.0162856319346,-66.97745,-67.006153297272,-66.948295,-66.9850946724131,-66.9818961366618,-66.9341829161231,-66.93371,-67.0007906312995,-66.97765,-66.9773656962781,-66.9774355492482,-66.977755,-67.055655,-66.982250748754,-66.9555771563856,-67.0114976687621,-66.9669956949991,-67.0214600858165,-66.9546673333691,-66.9504686774263,-66.9513697540428,-66.9567976933692,-66.9450804138031,-66.9447557906273,-66.9452898798228,-66.94492,-67.056284683889,-67.0575012640768,-67.0561056067637,-67.0567076997382,-66.973795,-66.8887687629239,-66.8888597655042,-66.887145,-66.887045,-66.888555,-66.888445,-66.89034,-66.878769152274,-66.88862,-66.888025,-66.878785,-66.88738,-66.88829,-66.890597634071,-66.8876482821527,-66.88813,-66.88773,-66.88791,-66.88695,-66.889045,-66.88745,-66.94155,-66.90876,-66.9081097311762,-67.013528356628,-66.9010841867732,-66.9373012936444,-66.9347771554175,-66.9381186272437,-66.9349177585401,-66.9341833337641,-66.93579,-66.9363328114668,-66.9329318639268,-66.93468,-66.88376,-66.883437047146,-66.884295,-66.88402,-66.8847825055342,-66.885135,-66.86988,-66.892875,-66.9713498150764,-66.971315,-66.97106084547,-66.890845,-67.005405,-66.9832269497115,-66.9822712771588,-66.9736595766782,-66.9707477015389,-66.967415,-66.9278995913479,-66.9279054895942,-66.928115,-66.91093,-66.936415,-66.94049,-66.94073,-66.962945,-66.941785,-66.9738238489738,-66.978515,-66.97853,-66.978565,-66.9335061489956,-66.8828775280392,-66.8836218509447,-66.9066214799448,-66.9625192229683,-66.9620037087654,-66.9615750911783,-66.9598688025902,-66.9321061292057,-66.904347668328,-66.93011,-66.947925,-66.95471,-66.9565213005478,-66.9807787684147,-66.9656125797751,-66.8829851497196,-67.003665,-66.9784218081528,-66.92273,-66.88215,-66.9639278674971,-66.9642509549236,-66.8949,-66.90633,-66.90694,-66.91054,-66.90998,-66.90805,-66.909265,-66.90587,-66.905545,-66.963425,-66.9438186204366,-66.9433165599032,-66.9632899858764,-66.96361,-66.9593789442719,-66.91145,-66.93777,-66.9203424456778,-66.92085,-66.94225,-66.93817,-66.94333,-66.920655,-66.942355,-66.9429865230916,-66.919559513848,-66.943305,-66.919955,-66.93852,-66.942315,-66.981945,-66.98169,-67.02263,-66.915999222114,-66.9160175394573,-66.916455,-66.91623,-66.9984476443559,-66.9285,-67.0250417170143,-67.0018780682313,-66.93592,-66.9833790922148,-66.97447,-67.0166215906916,-66.98278,-66.983015,-66.947645,-66.962745,-66.9209256865174,-66.9209975523903,-66.9207949729486,-66.91547,-66.91745,-66.9149652661223,-66.915315,-66.9041647384048,-66.91296,-66.915585,-66.9162256378378,-66.9141313321996,-66.908345,-66.907045,-66.9061454614798,-66.9053330716377,-66.9113485856727,-66.9076253531578,-66.90573,-66.97491,-66.9823802228488,-66.9908736828059,-66.906865,-66.8710012788206,-66.87102,-66.871025,-66.9404861352666,-66.8881403565651,-66.957265,-66.913192903441,-66.91555,-66.911835,-66.91443,-67.01809,-66.9544762128454,-66.929152768933,-66.9066,-66.962592136304,-66.90716,-67.0014393218709,-66.9155938532285,-67.001556144385,-67.0011288418618,-67.00136,-67.0024047788054,-66.9588473824088,-66.90441,-66.9044765537055,-66.8718122617427,-66.8713262097567,-66.8719995791591,-66.9667832941242,-66.9551557989517,-66.95583,-66.980435,-66.9306488690727,-67.0337520388813,-67.03338,-66.980675,-66.9801306140452,-66.870535,-66.870485,-66.870605,-66.88794,-66.887676271277,-66.8883312416601,-66.97279,-67.0189100069872,-67.0209333577668,-67.0197191728815,-67.0418412339867,-67.0585436049626,-67.0595909908367,-66.94798,-66.950625,-66.9502941222883,-66.9506,-66.950015,-66.9502180363009,-66.95056,-66.9591769218803,-66.9600924456937,-66.98329,-66.982412173822,-66.9828538127871,-66.982013863671,-66.904025,-66.9022871211365,-66.90315,-66.94785,-66.905435,-66.9308627417648,-66.944015,-66.94424,-66.9437409118822,-66.944455,-66.9435,-66.94385,-66.9797050841789,-66.9470388082814,-66.94557,-66.936495,-66.93649,-66.9362623154332,-66.936415,-66.936355,-66.9951499535129,-66.9953540072525,-66.964795,-66.9636528879236,-66.9051862060799,-66.9418511309255,-66.94162,-66.9880954594937,-66.987960497547,-66.94021,-66.869595,-66.86977,-66.9164871429399,-66.9441,-66.897625,-66.8969232168141,-66.902995,-66.9027847569814,-66.8995669096983,-66.9683,-66.927715,-66.9474308872193,-67.0688475658851,-67.066940994061,-67.0680569853969,-67.0588392991268,-67.0624825534262,-67.0651594682036,-66.946785,-66.9692840404743,-66.9661064924225,-66.95817,-66.95782,-66.944310060479,-66.9789941045697,-66.9433606133907,-66.9556115181923,-66.9579411062049,-66.9470150803339,-66.950842810113,-66.9446396554137,-66.9582811096983,-66.95821,-66.942574360055,-66.9749314511968,-66.9629043786603,-66.96574,-66.9318167388785,-66.9313516665871,-66.9722259434946,-66.9728031907561,-66.920765,-66.9846994533102,-67.00838,-67.00874,-66.9318358085671,-66.915755,-66.9157666661354,-66.9157132808117,-66.91571,-66.91969,-66.91817,-66.918995,-66.91955,-66.919835,-66.916775,-66.91796,-66.915835,-66.9171431508071,-66.916095,-66.916285,-66.9151,-66.91658,-66.91824,-66.919275,-66.9161306758512,-66.916415,-66.91749,-66.91871,-66.9154286666781,-66.9157449669236,-66.915415055618,-66.917715,-66.915905,-66.9181155438328,-66.91513,-66.918505,-66.91837,-66.9159664967534,-66.92975,-66.9300432077608,-66.9935873593854,-66.9957742400152,-66.9944539598741,-66.9697088208612,-66.9741951146956,-66.97359,-66.9736452868901,-66.973595,-66.97906,-66.9154422043934,-66.88453,-66.8845493181725,-66.8846,-66.8847497574175,-66.88459,-66.88456,-66.884605,-66.8845948639207,-66.8846,-66.9924978233169,-66.974441463167,-66.9747392416365,-66.9740982674217,-66.9745609569963,-66.9740957115439,-66.9735259386213,-66.9082569696442,-66.907859403811,-66.904085,-66.90416,-66.9080955919387,-66.8995300769641,-66.906444203197,-66.8987696523381,-66.9493102895092,-66.94987,-67.0234249746712,-67.0015418004231,-67.00179,-66.9983002423329,-67.022610774024,-66.8822749333266,-67.081895,-66.9261430744625,-66.925315,-66.9271290500056,-66.92512,-66.9268654027422,-66.9268443566487,-66.9269989824652,-67.001485,-66.88624,-66.8866302760683,-66.8872434535418,-66.88683,-66.8868117880827,-66.8867576261287,-66.8867756814012,-67.0243214345507,-66.9188620817442,-66.94805,-67.0085231113399,-66.913275,-66.9122895369928,-66.9147842436007,-66.9141784100306,-66.95859,-66.9437251193266,-66.9315852375485,-66.94991,-66.9651241867733,-66.9153827859553,-66.9151017695711,-66.914558582806,-66.9157013150462,-66.97425,-66.974215,-66.97416,-66.9281800015623,-66.9469475247576,-66.8793835023095,-66.8793716172636,-66.987885,-66.98801,-66.967855,-66.9671,-66.88248,-66.8807223640166,-66.88208,-66.88145,-66.881715,-66.8804839259009,-66.88116,-66.8812111248922,-66.881075,-66.8823408578644,-66.881085,-66.880795,-66.9206397060907,-66.934595,-66.935188418654,-66.9353354485129,-66.94188,-66.9290814236237,-66.9391559659521,-66.9219,-66.9296778818255,-66.9348969147682,-66.9397546931593,-66.940395,-66.94014,-66.9590132456564,-66.9979730721591,-66.93247032136,-66.877182826177,-66.8780880171892,-66.9805960113951,-67.0938378843938,-66.9586964726479,-66.9972854355436,-67.02288870994,-66.9738719421879,-66.9651691820399,-66.9855982045147,-66.9843518766111,-66.9846366509005,-66.9831500217325,-66.98375,-66.8862614586665,-66.8853881471966,-66.890125,-67.0351022791542,-66.9761790540519,-66.9749552705979,-66.934652688262,-66.89192,-66.912375,-66.950995,-66.951235,-66.9506369564123,-66.949025,-66.95164,-66.9502512159146,-66.94779,-66.94822,-66.94859,-66.9951831100265,-66.9948491300834,-67.07654,-66.913615,-66.913735,-66.9998833247609,-66.9303101991172,-66.94804,-67.0030429198143,-66.9930908086256,-66.9934625719252,-66.9971989113658,-66.9978972987603,-66.9974705586577,-66.995265034418,-66.9942779394918,-66.9964390772019,-66.9586813471788,-67.0104577810862,-67.041225,-66.9190374928213,-66.986614452998,-66.944245,-66.9438277927012,-66.9665642305071,-66.93777,-67.0199247562588,-67.0201550362567,-67.01946,-66.9945524603544,-67.0332670536764,-66.93524,-66.935665,-66.936,-66.9818749388271,-66.924865,-66.943245,-66.943435,-66.9390519186832,-66.9389646679225,-66.9375037849207,-66.8641465027268,-66.92541,-66.872465,-66.975985,-66.9208694984283,-66.9204863345137,-66.9144875645437,-66.9119434290372,-66.9128115445195,-66.911675,-66.9139316581453,-66.9899623628452,-66.9892275643831,-66.92529,-66.965985,-66.9657621954446,-67.0216249066485,-66.9313150835661,-66.93147801343,-66.93133,-66.931625,-66.931415,-66.9311795905533,-66.9308423579721,-66.931,-66.8945405129353,-66.943115,-66.88499,-66.88552,-66.906605,-66.923565,-66.9164477211877,-66.917845,-66.919315,-66.91878,-66.91924,-66.9175379609534,-66.916275,-66.9167750455586,-66.91882,-66.9171454216997,-66.91811,-66.917305,-66.917105583831,-66.918365,-66.918625,-66.91901,-66.91725,-66.926035,-66.9253934333017,-66.92539,-66.925835,-66.92557,-66.925295,-66.925115,-66.995636839843,-66.9726837643614,-66.9726714516204,-66.8803227744944,-66.924165,-66.924365,-66.9237750719633,-66.9071344139148,-67.0465700059226,-67.0482988128038,-66.9925564717541,-66.9918843466654,-67.0070917579566,-67.0066496977833,-67.0038841525923,-67.0077316270026,-66.9293984604989,-66.92916,-66.9283960930971,-66.929175359444,-66.9295073606798,-66.9506727983858,-67.011312245593,-66.921035,-67.0146155228199,-67.01202,-67.0079380244938,-67.0131018006585,-67.0121625675581,-67.0115678506626,-67.0124,-67.0096457918471,-67.0072819605111,-67.012515,-67.0126149503242,-67.012645,-66.93604,-66.936635,-66.9293122787952,-66.9389327582879,-66.963525,-66.96014,-66.9485766789188,-66.981625,-66.884865,-66.9341876093144,-66.9349956590388,-66.92136,-66.92156,-66.9568916899959,-66.9992008482596,-66.919365,-66.9611101324438,-66.8722028094225,-66.97443,-66.882410644467,-66.9007701870344,-66.918985,-66.935490577556,-66.9356760872171,-66.9330861671934,-66.9334709748599,-66.9321135883877,-66.935115,-66.9335,-66.9324347142238,-66.9306402198712,-66.9353,-66.9337655706564,-66.935570990155,-66.9411633796729,-66.988195,-66.9882986666756,-66.86714,-66.97242,-66.9729849778135,-66.9726,-66.9936219565238,-66.8847779423651,-66.8849,-66.9064932486456,-66.904895,-66.90543,-66.9208251492891,-66.9624306422325,-66.9755888382931,-66.902405,-66.9304473505025,-66.894785,-66.8947605483629,-66.9823179066573,-66.9567064628887,-66.9575670622567,-66.95686,-66.91252,-66.8990374953585,-66.91183,-66.9122268281744,-66.91279,-67.0305673587981,-66.89164,-66.8925746545464,-66.89093,-66.9847415367712,-66.90331,-66.870455,-66.907525,-66.907135,-66.90687,-66.907685,-66.907005,-66.90738,-66.907455,-66.90727,-66.907595,-66.907775,-66.93022831663,-66.9735313512889,-67.0153530227922,-66.9787763209129,-66.9418,-66.9416831277008,-66.8860900139829,-66.9645827962646,-66.8989468598059,-66.899415,-66.901335,-66.902415,-66.90339,-66.900095,-66.900655,-66.901905,-66.902145,-66.90463,-66.905205,-66.92901,-66.91216,-66.9130850745424,-66.911735,-66.914125,-67.0285692829901,-66.9671737846715,-66.9354235296422,-66.9140857077814,-66.914165,-66.9141254643283,-66.9925032930151,-66.9423627067257,-66.9428485502697,-66.89207,-66.892435,-66.96031029905,-66.88615,-66.954745,-67.01932,-66.943985,-66.9025758974377,-66.90209,-66.932385,-66.9830127249348,-66.9837798445766,-66.9901314316331,-66.98926,-66.989191295687,-66.9911593683612,-66.9834254662406,-66.9408554098042,-66.9406936532811,-66.9403582598209,-66.9402064695004,-66.9394431938755,-66.9918772090425,-66.8959037187732,-66.92447,-66.924805,-66.9238264138964,-66.925135,-66.92414,-67.0413234891951,-66.90965,-66.91755,-66.917663880012,-66.9711202294797,-66.9575467574679,-66.8713817993232,-66.914815,-66.9804243102268,-66.9473449097328,-66.9447614424423,-66.9437790323164,-66.9441815176746,-66.9447097126244,-66.9444157887232,-66.9786497733356,-66.979129158147,-66.97911,-67.0218619836456,-66.9582580161663,-66.957855,-66.9668781887837,-66.95747,-66.955885,-66.96431,-66.9472863724134,-66.91447,-66.9566683224287,-66.9666104295069,-66.9571756197356,-66.955925,-66.95765,-66.9554330492664,-66.95782,-66.95203,-66.95116,-66.95149,-66.95186,-66.95579,-66.9522844794603,-66.949372514664,-66.96008,-66.951685,-66.9531606285269,-66.9573962492953,-66.945,-66.9416961800164,-66.9418375598867,-66.9748364394607,-66.95951,-66.95925,-66.959355,-66.932225,-66.93228,-66.9327360345538,-66.93218,-66.934032824882,-66.9312492974456,-66.9797095761582,-66.8668626159127,-66.8660014018669,-66.867475,-66.9965645400623,-66.9488649500828,-66.94998,-66.950115,-66.870965,-67.0044825730556,-66.9947607338715,-67.0036497592204,-67.0028018258286,-67.0038853922052,-67.0009837929867,-66.9956447652793,-66.9976449923647,-66.964455,-66.964715,-66.96626,-66.9646,-66.9883922280005,-67.0670777555308,-66.96378,-66.91583,-66.95951,-66.96853,-66.96763,-66.96811,-66.9677746241423,-66.96413,-66.94602,-66.916015,-66.9186427278901,-66.9634893925711,-66.95937,-66.9592763624065,-66.96787,-66.9682125609754,-66.9512814777427,-66.9649063064647,-66.9646540797434,-66.96861,-66.959345,-66.9182709571785,-66.91752,-66.95961,-66.91620566352,-66.918055,-66.968325,-67.0483233479898,-67.049674040547,-67.0527958076679,-66.9609944985243,-66.951495,-66.9138377598175,-66.912985,-66.9088068202833,-66.908335,-66.915485,-66.914595,-66.91233,-66.911215,-66.91175,-66.9099698506767,-66.915055,-66.9513714730323,-66.96238,-66.96566,-66.9670095666966,-66.9649130668327,-66.9633713435222,-66.9659073951685,-66.9692391520981,-66.9697858835728,-66.9637246284455,-66.966165805579,-66.9671286767463,-66.9856369606482,-66.9859684992757,-67.0528818036414,-67.051545,-66.9271399092774,-66.92737,-66.9917182781074,-66.99134,-66.9448976929492,-66.8906808940147,-66.89004,-66.890675,-66.890515,-66.8906047490723,-66.953355,-66.94272,-66.94298793298,-66.9427,-66.93522,-66.9279288067383,-66.9355,-66.983085,-66.9409444563061,-67.0233452422746,-67.0240125476169,-67.0237686702374,-66.90358,-66.9035328622684,-66.903505,-66.9135154427095,-66.8795310411943,-66.879222760975,-66.8800102250243,-67.0154880771388,-67.0198959006523,-66.9855266223193,-66.9871281272091,-66.9815373295552,-66.9821367103844,-66.92634,-66.937845,-66.935415,-66.93743,-66.936825,-66.936135,-66.8809759503949,-66.9326087659142,-66.92018,-66.964755,-67.0492942383568,-66.9762608517493,-67.0268085903974,-67.0335173477319,-66.919485,-66.91891,-66.9570500969412,-66.93185,-66.9314255809722,-66.89498289785,-67.0205351214585,-66.9248551219039,-66.9906040594568,-66.934525,-66.9846868146075,-67.0393273825384,-66.9365311579309,-66.92329,-66.923515,-66.91592,-66.904155,-66.9047000900795,-66.904475,-66.904125,-66.9044247804948,-66.904145,-66.904025,-67.0018573278473,-67.108585,-67.0520841798373,-66.98534,-66.97805,-67.0013112297442,-67.0492677734135,-67.0250103584156,-66.9697377891791,-66.970485,-66.97027,-66.969875,-66.9700376652193,-66.9572568544571,-66.91723,-66.93421,-67.0031108274783,-66.9060606410027,-66.893635,-66.9860524350002,-66.8845275347072,-67.03023,-66.9761991089043,-66.88801,-66.8894188701801,-66.888445,-66.965955,-66.964835,-66.8863630524693,-66.91583,-66.9507684177981,-66.884710332572,-66.96542,-66.91619,-66.916575,-66.96591,-66.94893,-66.9175530503976,-66.965685,-66.9455215032832,-66.964945,-66.96518,-66.93753,-66.93744,-66.937295,-66.9367469906124,-66.95116,-66.939835,-66.9433302494799,-66.9873652923362,-66.9899197532198,-66.9938174960405,-66.9912265486784,-66.9870580603303,-66.988805,-67.0130290658773,-66.9413196326634,-67.0126711525877,-67.012468487001,-67.0113213830069,-67.0121641546221,-67.0116535598212,-67.01244,-66.9249,-66.8896933829006,-66.884145,-66.8831684232024,-66.8845850085399,-66.88331,-66.883571078264,-66.8833970678895,-66.9446252050478,-66.955725,-66.9402337217455,-66.9642801055326,-66.964595,-66.956565};
                Double[] Y = {10.43581,10.5292817208448,10.4987933390675,10.499645,10.4655396125874,10.5002735462938,10.4651286113822,10.4646153218654,10.4993,10.464405,10.46992,10.469605,10.47082,10.4734750743115,10.47393,10.47378,10.4715865629433,10.470925,10.46821,10.47417,10.4710483195623,10.4719136868234,10.46937,10.47462,10.47477,10.46913,10.4713387903321,10.471055,10.474005,10.4663130183711,10.47056,10.468505,10.470175,10.468775,10.466865,10.46721,10.47432,10.4727497713515,10.4712197797615,10.474075,10.474465,10.467805,10.468865,10.49946,10.4997346336371,10.4561044036388,10.5141512354916,10.46675,10.4321658522431,10.5173538035331,10.4668975175306,10.497575,10.44858,10.4384720304213,10.4849512157608,10.4299719818161,10.4298281553674,10.49604,10.4966030896051,10.4961525307035,10.495935586447,10.5129530979832,10.4679199980185,10.467475,10.47051,10.4690073088113,10.4269772645467,10.500815,10.4603803702621,10.4173443798263,10.494495,10.500505,10.49986,10.502035,10.50325,10.504455,10.50129,10.50094,10.50109,10.5056788945104,10.497,10.4984474813678,10.482085,10.512825,10.4788776957722,10.4808946151508,10.4795028201307,10.4783548784971,10.453985094992,10.5253666591802,10.50983,10.4283161436534,10.4270658993956,10.426455462925,10.4266894472923,10.4254573791608,10.411285,10.41545158564,10.5067032023358,10.4311113284895,10.515425,10.4179182355846,10.476665,10.465755,10.4661098040651,10.47067,10.4352998004621,10.4996949608283,10.4330840442505,10.434265,10.500425,10.50314,10.50331,10.479832093624,10.49846,10.4879524239957,10.5291439395084,10.4662419921537,10.5371287354979,10.5217034087606,10.523732126437,10.523715,10.5235684236077,10.5236950509143,10.51881,10.4699042413072,10.50058,10.500575,10.50058,10.435515,10.4686708464937,10.46853,10.468841970116,10.5012187562131,10.4682,10.46906,10.493412549203,10.4920971118999,10.468355,10.50399,10.504245,10.51856,10.4554260386164,10.45565,10.5048861241684,10.4871742384978,10.482375,10.4595809222098,10.4665976844722,10.4938600280572,10.4946799765674,10.3956,10.469947342026,10.4993793178211,10.499435,10.4660332240436,10.486648772657,10.4862510746753,10.4864855309444,10.487420746705,10.4675543218141,10.469095,10.4684534068828,10.4678439096046,10.496445,10.478335,10.4637839874124,10.464595,10.468605,10.4599195266641,10.4734903600302,10.469018894037,10.467445,10.4669832270213,10.4713684740915,10.46957,10.467165,10.4666,10.46996,10.4775528227471,10.4777107397995,10.4783403378268,10.4793485206332,10.5179841987996,10.4292625938623,10.51328,10.5134115609111,10.513335,10.51599,10.5183407499412,10.51482,10.517905,10.515325,10.512955,10.5175182410007,10.51414,10.51152,10.492887258017,10.4937647651416,10.493435,10.4930273356708,10.490248541916,10.4921705850516,10.4960236881149,10.4941028576943,10.4920794079345,10.4914431199543,10.49661,10.49796,10.4990562845531,10.489237052435,10.490175,10.48463,10.4853427400897,10.522315,10.52232,10.4938963804018,10.4927293218258,10.4935813217546,10.4722000373621,10.4832082374698,10.4822091313027,10.4837,10.48294,10.483185,10.482675,10.4831881549359,10.5059215688622,10.48276,10.4823146745616,10.482145,10.48257,10.4822797487373,10.5043760627349,10.502989007992,10.5035299661589,10.5020951277631,10.5029493675892,10.5033808676005,10.4815994676918,10.4807352925232,10.482525,10.4556616794971,10.4736962435763,10.5124786087329,10.5258,10.50478,10.511445,10.42561,10.436265,10.51962,10.4736846975804,10.5076,10.510515,10.504895,10.509045,10.50619,10.5055147275528,10.5056073134514,10.5055365138308,10.5207909283992,10.414225,10.4418123453736,10.4694811076683,10.4687307261327,10.4436,10.4740808142031,10.4608066399058,10.4400179570055,10.500375,10.4737187796244,10.4713901676767,10.4702954636138,10.4692689187524,10.4702354391053,10.4722365693308,10.4703203684493,10.4708577272603,10.4692541713145,10.4697593281851,10.470495,10.4992969773372,10.436445466155,10.4355675077769,10.478075,10.478805,10.476935,10.47931,10.47852,10.5032092778253,10.5154723313504,10.4997579292049,10.50035,10.503075,10.5041014027559,10.5020156160624,10.5026947531869,10.4776787729909,10.4763894574304,10.5153,10.47781,10.442695,10.523165,10.5016597421729,10.5026614984991,10.5033036600756,10.503215,10.478305,10.4788663040929,10.4786230260509,10.4794143196828,10.4777786572279,10.4791173158762,10.470433062367,10.47063,10.3955500819992,10.3998694152589,10.50973,10.51024,10.5090505121514,10.5087,10.501085,10.5022895916397,10.4362420725158,10.459485,10.503291401094,10.5034447978269,10.503295,10.446715980091,10.4114319597034,10.502894571677,10.502995,10.528795,10.47626,10.511895,10.5125384161925,10.47218,10.471265,10.4730035678469,10.4593051815107,10.4584992352065,10.426985,10.4698055825359,10.465275,10.4541941600614,10.498295,10.489362207441,10.4757069180273,10.4780900460024,10.4759540630708,10.47786,10.4771509958601,10.4974517580521,10.5148410000643,10.51239,10.528654662947,10.5188478715899,10.519665,10.4105841771706,10.4100365759595,10.45696,10.4778696424934,10.4810845581277,10.493008106561,10.4697482914719,10.4784139874161,10.4788927118269,10.4731347623747,10.4768070839506,10.4933353441675,10.4614371357474,10.4842679936262,10.4614921022367,10.4584263434122,10.4804692104003,10.4780666956679,10.4771202893941,10.4777146277679,10.4768543243599,10.4619839096041,10.4608261734033,10.4910712592969,10.4810378748309,10.4805249326563,10.4716329452273,10.4710582096967,10.4835616436962,10.4812772605415,10.48088,10.4538630440797,10.4745447664509,10.4810509749571,10.4615697654316,10.4807697701951,10.45840699956,10.4707717070324,10.4783591673891,10.4693607457788,10.458285,10.4617717191567,10.4824360371865,10.461095357407,10.4824401720437,10.4797304259346,10.4932196819412,10.4612984935586,10.4610865287682,10.478365,10.4564420688096,10.471065,10.4518865498823,10.486581499315,10.460815,10.47076808466,10.4704690953799,10.4754506531279,10.47755,10.4771788076545,10.4792348536881,10.45387,10.46131,10.4913082245601,10.4715604938101,10.47836,10.46068,10.4607947147888,10.5123637143608,10.512625,10.502205,10.5027865030183,10.502385,10.523620363639,10.5239380907353,10.5238278885438,10.5226938503455,10.4860743089176,10.4840688910169,10.4848726318646,10.4853524896876,10.484895,10.48496,10.5031619139246,10.50331,10.50246,10.48517,10.485065,10.48485,10.485605185946,10.48668,10.4851413944487,10.48522,10.4833693472024,10.4855322908134,10.485225,10.4847469348589,10.48514,10.485095,10.5037836930682,10.503905,10.5035684741149,10.50293,10.50304,10.502775,10.4354203319237,10.5210835130173,10.4113998481325,10.4578434498569,10.513095,10.4776141850627,10.48472,10.48523,10.485755,10.486295,10.484445,10.4996581281051,10.5088413575688,10.5053638569648,10.4688396077716,10.4680541212272,10.500324304054,10.5001104950976,10.460615,10.4996674056576,10.4613475369015,10.5080582905146,10.4912225033711,10.4578614808104,10.488085,10.48300726574,10.48208,10.482395,10.4776426451046,10.4564593416818,10.4432495111491,10.4442654513399,10.5223794035574,10.5226677335395,10.528045,10.49976,10.49722,10.4975039826511,10.4975652023089,10.4978461436596,10.4974306658756,10.4973969340769,10.4992101400345,10.4997370140681,10.4978174754841,10.4965936989892,10.5007882916425,10.5002127590187,10.5004441611235,10.4357343950688,10.5058684727448,10.504905,10.5069216095179,10.4476312420801,10.5118105601826,10.5403685743871,10.476385,10.47703,10.477307753012,10.5384652328305,10.4695761813494,10.5124865905899,10.525555,10.5253475269119,10.399005,10.3985746862094,10.455665,10.455875,10.4554619875188,10.4555522759621,10.5193291840732,10.4874422054589,10.4746672034575,10.4579508032378,10.5101361991485,10.503915,10.50318,10.5020061793575,10.5039832021716,10.50113,10.5012772243525,10.45294,10.45481,10.4595560513924,10.5109974456778,10.5069888722873,10.466085,10.49597,10.496137199837,10.49474,10.4963775927691,10.4956852585404,10.4956511068565,10.4965951517441,10.494915,10.4952098595793,10.49588,10.494635,10.495235,10.483985,10.5191856790968,10.518295,10.4779984002744,10.478475,10.4787053623253,10.4790963046596,10.4245377962457,10.46972,10.4110456887514,10.5027206454825,10.433875,10.453925,10.47958,10.5189199915115,10.5190908531059,10.4711167125804,10.4700643396831,10.5190743509248,10.4713292807513,10.4712743747751,10.50054,10.5070258677096,10.49127,10.51434,10.5141449546945,10.51408,10.510975,10.51133,10.5111306292206,10.5108356362505,10.5208225408576,10.52062,10.46518,10.4606868176368,10.46007,10.5020464792989,10.4632157822461,10.4655870943058,10.464,10.463995,10.4617911552993,10.462446885684,10.4657323205483,10.50177,10.464965,10.464,10.4644751064914,10.46388,10.4638992861875,10.465395,10.48034,10.48002,10.4484847846699,10.518155,10.511485,10.432545,10.5230095257867,10.46915,10.4681884456225,10.4536902490949,10.4650292933956,10.49368,10.4947441023521,10.4941612304213,10.493139432371,10.49943,10.3966500648434,10.5287,10.5290931414806,10.5131119092333,10.518545,10.5184084320661,10.51842,10.5182751418484,10.4674396165995,10.4342,10.504625,10.504855,10.500075,10.5014611672028,10.5011,10.4991403621454,10.4777460633906,10.4730553121241,10.47495,10.5209990353758,10.474731920515,10.5043889788617,10.47401,10.519946021938,10.473445,10.5193150292051,10.5241745656921,10.4848020202084,10.4848814177286,10.4850158031811,10.4321331920958,10.4828472350429,10.491356582867,10.519305,10.51776,10.51635,10.516845,10.51859,10.51081,10.4849892620387,10.4307804949913,10.474065,10.442985,10.488249587893,10.4751325313891,10.511445,10.483944156791,10.4841494379804,10.51029,10.51126,10.494575,10.4906889884049,10.4860100466178,10.4772399436908,10.4854536474876,10.4847773314543,10.489360253052,10.4819810023904,10.46076,10.4794903774681,10.46135,10.475215,10.511833948933,10.47601,10.484215,10.4850738753072,10.4429405399031,10.442995,10.4839384714052,10.478675,10.472685,10.49975,10.48053,10.48022,10.513425,10.5065991711415,10.5059543172273,10.506425,10.433945,10.45837,10.5035347848115,10.503348916847,10.47599,10.4297146189038,10.4425819929168,10.4428378089689,10.4423031882579,10.47893,10.4318726145066,10.4321070846115,10.4306529354623,10.43192,10.4932105837875,10.4925143670047,10.51438,10.461175,10.4667963264873,10.5179420499243,10.517465,10.49234,10.4507077579174,10.44928,10.4492624264218,10.51194,10.5124434768501,10.4704294523434,10.470653682486,10.4341,10.516365,10.4805134289394,10.4376418044139,10.4592070207031,10.4835069518408,10.522145,10.464915,10.5270391421356,10.526891116237,10.4993864149647,10.5008416486059,10.510335,10.5110622224265,10.4992719289643,10.5106516607475,10.509315,10.4991518695442,10.5099513117406,10.4996779597511,10.5009736798762,10.4942341738113,10.4932257623679,10.4334035906542,10.4765391910747,10.511225,10.5111389821892,10.5176485152789,10.5155353557929,10.4726344183994,10.5138279775791,10.4831,10.48615,10.48371,10.48446,10.48731295915,10.48528,10.5027293002591,10.5018541099031,10.5004679427714,10.5017745920968,10.5014949773825,10.503030659804,10.5025907603222,10.5002885663006,10.4430348412662,10.5158536216015,10.51609,10.51629,10.440905,10.497695,10.449785,10.450985,10.498,10.4519875617639,10.4983563271784,10.496977565769,10.451245,10.4495083231193,10.4503580683184,10.4890217343344,10.4900699112603,10.4741959502438,10.504795,10.50531,10.50429,10.50418,10.5051,10.5054613168952,10.5045635331457,10.5040656655486,10.5044638399548,10.4102551541561,10.5231893145854,10.5220928286408,10.52209189819,10.521435,10.52266,10.522925,10.5200112795226,10.5208478993762,10.52302,10.50884,10.4252874932235,10.4780042169381,10.47787,10.4780289680881,10.5098314114063,10.5117702692714,10.5104160991401,10.5080905103868,10.5173417375717,10.5369788588655,10.4684530174201,10.518145,10.5058315387448,10.480025,10.501484128016,10.4912276918271,10.48138,10.4461375730614,10.4331484283779,10.5196818193241,10.5028890967203,10.4255295403439,10.4721125486338,10.4386926849625,10.4751090238211,10.5051142463597,10.4390602822333,10.4962826235669,10.4966751149127,10.4963255600493,10.4959391248674,10.4932139012895,10.51245,10.512405,10.4989,10.49911,10.521215,10.5208897327098,10.521115,10.500095,10.49942,10.49969,10.5011977647121,10.4381831981351,10.43839,10.438395,10.510390698014,10.4601776100164,10.4770348983754,10.491825,10.4909795877425,10.4250031816738,10.4545817775921,10.45395,10.4229930119252,10.43678,10.4432487784082,10.4527316386259,10.4422244467771,10.4354487870385,10.4461701285034,10.4553958139631,10.45271,10.4418656189946,10.4521,10.4245786400251,10.452925,10.4505752437429,10.4299416724776,10.4256854930317,10.4563544845117,10.4526300392431,10.4524080053053,10.4449614972504,10.436915,10.44271,10.4433431872462,10.4393884789812,10.4469930616152,10.4341826069939,10.464377588635,10.4651,10.4645747015131,10.46493,10.4651,10.4199833442091,10.4222892464799,10.4433601117039,10.442405,10.470517105436,10.4694758450827,10.4125517354872,10.411429952674,10.4115394507781,10.415503853621,10.4147853961588,10.4683607126199,10.46935,10.518135,10.543045,10.5452299477526,10.5422680540816,10.5419698669444,10.5461301911305,10.481515,10.4894417694168,10.467725,10.486895054092,10.50071,10.48339655703,10.4791839487518,10.499418129077,10.5004612087341,10.4547357824865,10.43956,10.4395281012406,10.4397364739274,10.43943,10.4832,10.5280082982864,10.51746716571,10.558685805071,10.5172372007886,10.5004999141835,10.4802674166175,10.4843675483825,10.4833833816525,10.4783875560616,10.5012287585906,10.5011743875031,10.502859731793,10.5019382117648,10.4816414513879,10.4827624906155,10.4819716318098,10.4824876997382,10.431585,10.5071509276778,10.5134025458577,10.50087,10.50169,10.50799,10.5083,10.51421,10.5112001727121,10.50776,10.509395,10.511025,10.5110343695374,10.50874,10.5143780858054,10.5102792946183,10.50916,10.51202,10.509655,10.50256,10.505685,10.511495,10.4377082842712,10.518015,10.5172752398641,10.4074785373446,10.478797750969,10.5085447875487,10.5115093547964,10.5065135269247,10.5060021981751,10.5055387501615,10.508555,10.5072916758546,10.50472,10.5097279762181,10.48492,10.4856637514689,10.4853,10.4851,10.485660666485,10.48596,10.497785,10.489815,10.5115037125989,10.510995,10.5123236013858,10.507645,10.481075,10.475702881503,10.4752990654099,10.5083085831565,10.5077251129772,10.47413,10.4245217067312,10.4252313647247,10.424755,10.5151,10.515795,10.50449,10.503965,10.504215,10.521325,10.4768792265392,10.43192,10.43184,10.43166,10.5176936568777,10.5002539614168,10.5028163482278,10.4661991366988,10.5066038925243,10.5066652500894,10.5065842109414,10.5058288097095,10.4897817031495,10.5227124278594,10.5352097469269,10.519445,10.471355,10.521022482864,10.4463923070123,10.5071635524888,10.5108079653388,10.49063,10.4375173941506,10.479665,10.49129,10.474026554279,10.4745644016478,10.51584,10.514555,10.514685,10.51541,10.515295,10.51492,10.51516,10.514485,10.51444,10.512855,10.5181987347886,10.5178529554313,10.5097460367213,10.509185,10.4717052492236,10.481095,10.52073,10.4580375543222,10.45752,10.52306,10.520795,10.52049,10.457725,10.523555,10.5215062117311,10.4588992817287,10.520595,10.45846,10.52084,10.523365,10.47068,10.470975,10.41951,10.5176087185257,10.5174987697286,10.51804,10.517725,10.4675768642467,10.492015,10.4875201695572,10.4849871814296,10.43593,10.4326525504161,10.500465,10.4071384093084,10.464105,10.46405,10.466945,10.51341,10.503529292806,10.5039933214636,10.5028604648332,10.50319,10.503655,10.5030638165306,10.50315,10.5008491655045,10.502635,10.50322,10.5033621768899,10.5028736293777,10.501645,10.50138,10.501202688953,10.5011106825862,10.502332103354,10.5014982460287,10.477215,10.49967,10.4541355560375,10.4821513536844,10.454675,10.5116425576412,10.51203,10.51184,10.437225203806,10.4655525134537,10.528485,10.4949992005984,10.49535,10.494805,10.495175,10.478095,10.5108066588422,10.4345232451369,10.463945,10.43410878344,10.445855,10.4974357287484,10.4641940629021,10.4753946313503,10.4743104656802,10.47445,10.4742448299767,10.471333640055,10.4708263866719,10.4713121470455,10.5100437964223,10.5102534164079,10.5088482210664,10.4351546246463,10.5191460532307,10.51948,10.46448,10.4924191402061,10.4165021360846,10.416095,10.435355,10.434941172969,10.497335,10.49788,10.49636,10.507495,10.5074208012574,10.5075794543461,10.4343,10.4182575055316,10.4178677167186,10.4184942011299,10.4710871822678,10.4913778919357,10.4866381284196,10.466415,10.521025,10.5206224897588,10.521175,10.52109,10.5214026678779,10.521385,10.5009682148413,10.5004662064913,10.433165,10.4333856038782,10.4332913724968,10.4331539971535,10.51802,10.5169316239561,10.517615,10.525795,10.51399,10.4850376131763,10.479205,10.479735,10.478569593882,10.480265,10.47806,10.478835,10.4788832772141,10.49328,10.499065,10.523955,10.523795,10.5243228167025,10.52392,10.523875,10.4015500348653,10.4030131876708,10.5175,10.5178082837059,10.5158963232001,10.5033438605611,10.503775,10.4308881729112,10.4316323218858,10.437345,10.511815,10.511825,10.5191528553228,10.502775,10.479845,10.4799588864874,10.483845,10.4823854188274,10.4795227750397,10.510915,10.45418,10.4338957486553,10.3958402975325,10.3948250994061,10.3949966836125,10.3951040477899,10.3939306383565,10.3942746011527,10.499345,10.534098384009,10.5303473693169,10.52958,10.531628105079,10.5290001572453,10.5429025594896,10.5181282453563,10.5287990890846,10.5305355751804,10.529542531241,10.5301788072441,10.5230810337588,10.5300655516703,10.529765,10.5172364415939,10.535199675961,10.5305814595534,10.53011,10.425631423473,10.4263547618139,10.4301095458711,10.4282694939887,10.48738,10.4815043843001,10.47614,10.47617,10.4409911701358,10.518185,10.5169866964203,10.5171729937313,10.518235,10.495975,10.50324,10.499255,10.49666,10.49526,10.510035,10.50438,10.51595,10.5082346240612,10.514385,10.513115,10.52046,10.511335,10.502905,10.497945,10.5137849311159,10.51254,10.506595,10.50066,10.5194277116873,10.5186754961465,10.5197214916886,10.505555,10.51582,10.5035700791286,10.5207,10.50168,10.5023,10.5149745227263,10.45283,10.4525700186471,10.4329608007682,10.4342685600038,10.4330141653532,10.5050329466534,10.4352695767352,10.431685,10.4314194262198,10.4316,10.496885,10.5309544087867,10.504125,10.5064390910328,10.50243,10.4984962956832,10.500555,10.50121,10.503575,10.4999616329513,10.50036,10.4942874826929,10.5156073166811,10.5176128963231,10.5103310765823,10.5170044336752,10.512871315834,10.5122249940197,10.5238290893275,10.526558807622,10.531105,10.531195,10.5226701671613,10.5401505387488,10.5283736952046,10.5327507313902,10.4629145657361,10.462105,10.4139875379932,10.4359311125327,10.436645,10.455853080355,10.41376935498,10.5111309157889,10.461975,10.5172976941531,10.51808,10.5147662000226,10.51856,10.5136142595864,10.5160649812969,10.4415117298091,10.426525,10.492225,10.4918497239317,10.4894314748032,10.491155,10.4894992847669,10.4896284864561,10.4902352210183,10.4903914345507,10.5174434600715,10.473865,10.4550868201206,10.51967,10.5190621236431,10.5203164792587,10.5201993124457,10.43276,10.4991242568536,10.4858070603783,10.47323,10.4693880622577,10.485727718895,10.4848533471182,10.4840414478256,10.4863557998489,10.433865,10.43409,10.434405,10.4340966661459,10.5182195881164,10.5064777419168,10.5059897035813,10.43701,10.436725,10.47347,10.473855,10.49824,10.5030754769882,10.499505,10.501345,10.50064,10.5043460188632,10.50807,10.5088690921594,10.507425,10.4987274264069,10.50207,10.50613,10.4554548002924,10.519185,10.5198982707579,10.5209352823794,10.480045,10.462961312875,10.4312875529541,10.506445,10.5371594091274,10.4838513222422,10.4968692439932,10.496625,10.49672,10.446469456081,10.3939792267993,10.4434800920775,10.5109198579531,10.5110102832587,10.5105023464367,10.40412,10.5290066695845,10.4667515505301,10.477974677485,10.5043365213057,10.5134587645624,10.5047118032872,10.5050979076787,10.5046093301801,10.5042521282368,10.504275,10.5010872248488,10.5030790500659,10.4894,10.414204154884,10.516397578829,10.5159913920669,10.5081423531602,10.510655,10.4954,10.518115,10.518255,10.517945717756,10.516905,10.518495,10.5176434450913,10.516125,10.516395,10.51663,10.4833492132508,10.4842630406668,10.460995,10.52039,10.52017,10.4342839854125,10.5057751806449,10.48144,10.4768578820422,10.5002765202156,10.5013529523659,10.4991015759471,10.4980408049589,10.4991792737416,10.499294965582,10.4998792722868,10.4993231920986,10.51761,10.4167159171035,10.46599,10.5217465039495,10.4537466794971,10.528135,10.5279074931135,10.5034900539233,10.51441,10.4215783003956,10.4233500402852,10.42094,10.4138989002532,10.4908899124988,10.48635,10.48734,10.4881,10.53090755391,10.48106,10.50393,10.50377,10.5187352859263,10.5181104553286,10.5122724929681,10.5109402343634,10.520715,10.503395,10.47585,10.5225932444992,10.5243089273067,10.5207878018197,10.519291131373,10.5201482818793,10.5188,10.5207560659506,10.4947052953556,10.4949755128766,10.44299,10.530365,10.5305789022777,10.4891533540781,10.5232247493017,10.5226608381535,10.522735,10.52216,10.5221,10.5236312283402,10.5244685433437,10.524075,10.5018038653655,10.49637,10.512205,10.512305,10.467865,10.512125,10.5052599923071,10.498985,10.491755,10.49428,10.4921,10.5003669718051,10.506335,10.503806449721,10.49407,10.5019860981782,10.497705,10.501385,10.5023652112487,10.49645,10.495115,10.493165,10.5017,10.43275,10.4321813677174,10.433235,10.43289,10.433095,10.4333,10.43343,10.5303023232417,10.5028114368097,10.5035443548613,10.5119381945204,10.454535,10.45413,10.4550193440345,10.4684646886816,10.4835946989146,10.4801543561589,10.3977639233563,10.4322585443161,10.48422,10.4841756463184,10.4841680906016,10.48398,10.506219486833,10.5057,10.5052200053296,10.5059423017385,10.5061726393202,10.4785618787725,10.4198680012157,10.480095,10.4582910449341,10.457025,10.4550523583414,10.4578008852745,10.4570232668807,10.4559552337751,10.45738,10.4557826189156,10.4545513289457,10.457495,10.4571049503243,10.457615,10.4864,10.485845,10.4730480388072,10.5098511213121,10.47968,10.43392,10.5007186380344,10.43258,10.512585,10.4869076175646,10.4880120347316,10.453375,10.453465,10.4784833799918,10.4566035879834,10.494495,10.4282441862359,10.4984766198238,10.50922,10.498709355533,10.4721105611031,10.48822,10.4207803465336,10.4255235555879,10.4263282379447,10.4207121770524,10.4217898469674,10.42353,10.42136,10.4230402471578,10.4219578048215,10.42289,10.4243186155173,10.4241219513629,10.4844034591122,10.48097,10.481376666689,10.50993,10.470755,10.4713224741158,10.43424,10.4868653985636,10.4937798919346,10.4954356538616,10.4806412278408,10.481485,10.481105,10.5087460633886,10.4904825819003,10.5228328514623,10.46946,10.497880340453,10.51421,10.5150349352658,10.4366823198308,10.4311349714529,10.4314745898832,10.43123,10.491865,10.4780571667888,10.49289,10.4921442467464,10.4917,10.4004927895158,10.479305,10.4801563145886,10.47863,10.4755310245141,10.4502,10.507905,10.49669,10.49848,10.499705,10.49598,10.4991,10.49735,10.49701,10.49784,10.49637,10.495635,10.5246029306608,10.50921,10.421999127849,10.4430752384233,10.51164,10.5120193041275,10.4936588317546,10.5089798660746,10.500858429903,10.50101,10.501415,10.50165,10.501865,10.501155,10.501265,10.50154,10.50159,10.50213,10.502245,10.48903,10.51921,10.5199026767191,10.518925,10.5205,10.4653147444698,10.501663205801,10.5083771755028,10.4899183516142,10.474785,10.4755021197686,10.470513051106,10.4980827067257,10.4985918325592,10.50987,10.510005,10.509474692342,10.5068,10.435855,10.47601,10.46496,10.4945562564344,10.495755,10.44179,10.464823638165,10.4645397705431,10.408149428204,10.408295,10.4080638742689,10.4078434656239,10.4361724437344,10.5172075411748,10.5182556500979,10.5187341911533,10.5195829451652,10.5202854949296,10.4098607005323,10.510202317487,10.492735,10.491935,10.494268367575,10.491145,10.493525,10.4710642986222,10.48697,10.4719,10.4724593299671,10.4718806409972,10.515890024764,10.5117207408978,10.47516,10.4723341664764,10.5051307595345,10.4894203120626,10.490703226215,10.4900309598062,10.4885061707871,10.4918406890673,10.522085979489,10.5221601683706,10.52244,10.5004390314957,10.5121056292643,10.485845,10.5037877206555,10.472965,10.486335,10.47839,10.4902977771884,10.460185,10.5115519543698,10.5030633050226,10.4718632406427,10.50351,10.47367,10.510803162449,10.47434,10.51637,10.51777,10.51723,10.516645,10.503835,10.4866913264344,10.4892263291146,10.48529,10.516915,10.4873315397359,10.5120116201877,10.47975,10.5197300495489,10.517868887982,10.4351635044118,10.47863,10.478085,10.47831,10.52288,10.522285,10.5213679613811,10.523435,10.5190360855794,10.5055469020873,10.5126459867554,10.5113730292324,10.5114056074678,10.511355,10.5425330890218,10.4686840599006,10.51231,10.512085,10.51211,10.482897961037,10.4854374314499,10.4833018355234,10.4838587648807,10.4829325754241,10.484357317999,10.4845125391201,10.4843277800401,10.51443,10.51472,10.5171,10.48574,10.4629052446665,10.4480505210179,10.48587,10.45715,10.50469,10.47009,10.46825,10.469205,10.4687544550484,10.486575,10.482915,10.457355,10.460098183246,10.48896,10.505605,10.5068336511221,10.468715,10.4696581010448,10.4913495586656,10.4877423427781,10.4876281594868,10.47026,10.50582,10.4606257155941,10.4589,10.50443,10.4575801856373,10.459405,10.469655,10.466631715542,10.4668177621667,10.4676405701185,10.508962446901,10.542815,10.4821869000622,10.482495,10.4843277562682,10.484635,10.481375,10.481855,10.482755,10.4832,10.48298,10.4836362112782,10.48161,10.5126440940502,10.4321380215593,10.44174,10.4396576230286,10.4428380996263,10.4470273960864,10.4409980685955,10.4436277277866,10.4427320983135,10.4454971892448,10.4409570617076,10.4471898771294,10.4745321107494,10.4759075181087,10.4826373692514,10.484055,10.5190787556702,10.519055,10.4810302980755,10.48151,10.4692738838266,10.5092404794179,10.5065600483308,10.508845,10.509825,10.5081001072496,10.499825,10.42342,10.4229241899338,10.42344,10.50651,10.4334947883611,10.52304,10.433295,10.4789532537238,10.4295875696348,10.4315938158234,10.4308468596178,10.51817,10.5193156438092,10.51699,10.4862210481632,10.5058271095522,10.50592255495,10.5053592881776,10.4764294322447,10.469676777053,10.4314899866958,10.425305518256,10.524782316021,10.5248445596075,10.41803,10.509795,10.509745,10.50979,10.50978,10.509765,10.5122746417467,10.4388722282064,10.45688,10.485295,10.4713721191784,10.4347752394116,10.4106031011257,10.4080701657668,10.47729,10.47754,10.5181329383253,10.438365,10.4380256444613,10.5108789447,10.4283456098177,10.454519860612,10.4892202972841,10.50575,10.5096387902617,10.4549357670054,10.5042351168557,10.48024,10.48108,10.48347,10.515405,10.5187296969518,10.518265,10.51523,10.5168402439397,10.51534,10.514755,10.4914685950626,10.456495,10.4914115009328,10.434735,10.50551,10.4977938798863,10.4670665722556,10.4668737015301,10.5286807969083,10.52856,10.528745,10.529305,10.5290248567901,10.50303,10.480035,10.503,10.45408,10.5201862031541,10.50906,10.4256958838887,10.4842436043594,10.4791760172335,10.5168648294899,10.509895,10.5104810495972,10.51006,10.471615,10.484225,10.4754581934987,10.458965,10.4903778413907,10.4758297862037,10.470435,10.459375,10.459785,10.471505,10.491575,10.4614736010467,10.47101,10.481855520502,10.469485,10.46993,10.49661,10.49637,10.49589,10.4944565367187,10.49659,10.437065,10.430149425746,10.4650064692521,10.4640676470216,10.4641945298206,10.4659621055826,10.46221,10.462505,10.4779784379825,10.51075,10.4218534904834,10.4228657412785,10.4192106154995,10.420585828709,10.4196389319363,10.422105,10.43344,10.507137121614,10.4946,10.4935918820026,10.4951393547177,10.493725,10.4940774076174,10.494226892965,10.47062,10.49813,10.4790991241439,10.4847101934764,10.485345,10.49772};           
                double a,b;
                int c,d;
                a = (Math.random() * 1000);
                b = Math.random() * 1000;            
                c = (int) a;
                d = (int) b;
                this.source = X[c]+","+Y[c];
                this.target = X[d]+","+Y[d];
            }
            
            System.out.println(this.source);
            System.out.println(this.target);*/
            //TEST
            String[]  params = {
                (cost == null ? "ftt" : cost).trim(),
                (preference == null ? "none" : preference).trim(),
                (theta == null ? "0" : theta).trim()
            };
            
            allPoints = this.preparePoints();
            result_path = new ArrayList<String>();
            
            relative_path = null;
            int count, mode;
            
            
            for(int i = 0; i < allPoints.length - 1; i++) {
                mode = keys.containsKey(allPoints[i][this.AZI]) ? Integer.parseInt(keys.get(allPoints[i][this.AZI]).split(",")[0]) : 0;
                count = keys.containsKey(allPoints[i][this.AZI]) ? Integer.parseInt(keys.get(allPoints[i][this.AZI]).split(",")[1]) : 0;
                for(int j = 0; j < 4; j++) {
                    System.out.println("Intentando buscar camino entre "+allPoints[i][this.LON]+","+allPoints[i][this.LAT]+","+allPoints[i][this.AZI]+","+allPoints[i][this.CUS_AZI]+" y "+allPoints[i+1][this.LON]+","+allPoints[i+1][this.LAT]+","+allPoints[i+1][this.AZI]+","+allPoints[i+1][this.CUS_AZI]);
                    relative_path = this.graph.getPath(
                            this.graph.coorToNode(allPoints[i][this.LON],allPoints[i][this.LAT],allPoints[i][this.AZI]), 
                            this.graph.coorToNode(allPoints[i+1][this.LON],allPoints[i+1][this.LAT],allPoints[i+1][this.AZI]), 
                            params);
                    
                    if(relative_path == null) {
                        count++;
                        count = count % 4;
                        System.out.println("No hay camino para"+allPoints[i][this.LON]+","+allPoints[i][this.LAT]+","+allPoints[i][this.AZI]+" y "+allPoints[i+1][this.LON]+","+allPoints[i+1][this.LAT]+","+allPoints[i+1][this.AZI]+". Recalculando nuevos azimuth");
                        allPoints[i][this.AZI] = allPoints[i][this.CUS_AZI].equals("true") ? allPoints[i][this.AZI] : azi_options[mode][count][0];
                        allPoints[i+1][this.AZI] = allPoints[i+1][this.CUS_AZI].equals("true") ? allPoints[i+1][this.AZI] : azi_options[mode][count][1];
                        System.out.println(allPoints[i][this.AZI]+" - "+allPoints[i+1][this.AZI]);
                        
                    } else {
                        System.out.println("Se encontro un camino");
                        break;
                    }
                    
                }
                
                if(i != 0 ) 
                    relative_path.remove(0);
                result_path.addAll(relative_path);
            }
            
            this.prepareResponse(result_path);
            
            //shutDown graph database
            //this.graph.shutDown();
            
        } catch (Exception alle) {
          alle.printStackTrace();
        }
        
        return SUCCESS;
    }
    
    /**
     * Used for Struts2 to get the path as a JSON
     * @return JSON o GEOJSON
     */    
    public HashMap getPath() {
        return this.path;
    }
    
     /**
     * Create graph and other stuff related with the spatial database.
     */
    public void initAll() {
        this.graph = new com.intraffic.itrouting.core.impl.Neo4jGraphImpl();
        this.graph.createDb();
        this.graph.prepareAstar();
        this.graph.createRMIInstance();
        this.graph.loadAllData();
        return;
    }
    
    /**
     * Update a link cost given the ID, direction and timestamp, The timestamp is used to set the speed confidence.
     */
    public void updateCost() {
        try {
            this.graph.updateCost(
                    (dir.trim().equals("C") ? node : Integer.toString(Integer.parseInt(node) - 1000000000)),
                    Double.parseDouble(cost),
                    timestamp
                    );
        } catch (Exception e){
            System.out.println("ITR2: Error actualizando costo. "+e.toString());
            e.printStackTrace();
        
        }
        
    }
}
